#!/bin/bash
# loads the met specific config
met_config=`find_config met.config`
if [ "$met_config" = "" ]; then
  met_config="$META_MODEL_ROOT/models/raster_met/met/met.config"
fi
echo "Loading met_config from $met_config"
. $met_config

nc_src_files=`ls $src_dir/*.nc`
echo "Trying to reproject $nc_src_files for $ddate"
for originalFile in $nc_src_files; do
  echo "Clearing pre-existing file ${originalFile}.repro.gtiff"
  if [ -e ${originalFile}.repro.gtiff ]; then
    echo "Clearing pre-existing file ${originalFile}.repro.gtiff"
    rm ${originalFile}.repro.gtiff
  fi
  extension="${originalFile##*.}"
  if [ "$extension" == "nc" ]; then
    echo "converting netcdf to getiff..."
    echo "gdalwarp $originalFile -t_srs EPSG:4326 -of \"EHdr\" \"${originalFile}.bil\""
	gdalwarp NETCDF:"$originalFile":Rainf -t_srs EPSG:4326 -of "EHdr" "${originalFile}.bil"
  fi
done
